---
apiVersion: app.k8s.io/v1beta1
kind: Application
metadata:
  name: "$APP_INSTANCE_NAME"
  annotations:
    kubernetes-engine.cloud.google.com/icon: >- 
      data:image/png;base64,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
    marketplace.cloud.google.com/deploy-info: '{partner_id: "nuodb", product_id: "nuodb-operator", partner_name: "NuoDB"}'
  labels:
    app.kubernetes.io/name: "$APP_INSTANCE_NAME"
spec:
  descriptor:
    type: Nuodb Operator
    version: v2.0.3
    description: |-
      The NuoDB Operator deploys the NuoDB database in Kubernetes. It also supports either ephemeral or persistent storage options with configurations to run NuoDB Insights, a visual database monitoring Web UI, and start a sample application (ycsb) to quickly generate a configurable SQL workload against the database.  See: [NuoDB's github](https://github.com/nuodb/nuodb-operator) for requirements and deployment instructions.

      # About NuoDB

      NuoDB provides a modern cloud-native, cloud-agnostic distributed SQL database that delivers on-demand scale-out and continuous availability for high throughput transactional workloads. Deploying new applications and delivering updates to existing applications rapidly are critical global business imperatives for enterprises today. NuoDB’s cloud-native distributed SQL database enables your organization to do both. Built on the radical notion that a database should never be what holds your applications or business back, we’ve liberated the enterprise-critical database from its inherent limitations. That frees businesses to focus on creating breakthrough solutions, built on a database designed for modern architectures. See: [NuoDB's website](https://nuodb.com) for more information.
    maintainers:
    - name: NuoDB
      url: https://cloud.google.com/solutions/#click-to-deploy
    links:
    - description: 'User Guide: NuoDB Operator Kubernetes Application'
      url: https://github.com:nuodb/nuodb-operator-gcp-application/README.md
    - description: Quick start with NuoDB Operator
      url: https://github.com/nuodb/nuodb-operator
    - description: NuoDB Documentation
      url: https://doc.nuodb.com
    notes: |-

      Once the NuoDB Application installs follow the below steps to create your database.  
      
      ### Required Tools Installation and Setup 

      To setup your local environment please install [gcloud](https://cloud.google.com/sdk/) and [kubectl](https://kubernetes.io/docs/tasks/tools/install-kubectl/)

      ### Authorizing your Account

      With gcloud installed in a local environment, log in as yourself:
      
      `gcloud auth login`

      The values for CLUSTER and ZONE can be found under the "Details" tab.  With those values, set two environment variables in your local terminal (example values are provided):

      ```
      CLUSTER=cluster-1
      ZONE=us-west1-a
      ```

      Configure kubectl authorization via gcloud by:
      
      `gcloud container clusters get-credentials "$CLUSTER" --zone "$ZONE"`

      Bootstrap RBAC cluster-admin for your user:

      ```
      kubectl create clusterrolebinding cluster-admin-binding \
        --clusterrole cluster-admin --user $(gcloud config get-value account)
      ```

      ### Deploying a NuoDB Database
      
      In the local terminal window view the operator details by typing:

      `kubectl get deployments -o wide`

      Create a file called nuodb_cr.yaml in your local terminal, using the contents below:

      ```
      apiVersion: nuodb.com/v2alpha1
      kind: Nuodb
      metadata:
        name: nuodb-test
      spec:
        dbAvailability: manual
        storageMode: ephemeral
        insightsEnabled: true
        adminCount: 1
        adminStorageSize: 5G
        adminStorageClass: standard
        dbName: test1
        dbUser: dba
        dbPassword: secret
        smMemory: 2Gi
        smCount: 1
        smCpu: "500m"
        smStorageSize: 20G
        smStorageClass: standard
        engineOptions: ""
        teCount: 1
        teMemory: 2Gi
        teCpu: "500m"
        apiServer: https://domain:8888
        container: nuodb/nuodb-ce:latest
      ```

      The file defines a NuoDB database with 1 Admin, 1 SM and 1 TE. You can configure different parameters as you like, for more information visit [Deploying NuoDB Database](https://github.com/nuodb/nuodb-operator#deploy-the-nuodb-database)

      Apply the file to your environment with the following command:

      `kubectl apply -f nuodb_cr.yaml`

      Wait until at least the admin pods is ready.

  componentKinds:
  - group: apiextensions.k8s.io/v1beta1
    kind: CustomResourceDefinition
  - group: apps/v1
    kind: Deployment
  selector:
    matchLabels:
      app.kubernetes.io/name: "$APP_INSTANCE_NAME"
